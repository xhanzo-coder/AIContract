{
  "info": {
    "name": "åˆåŒæ¡£æ¡ˆç®¡ç†API - å®Œæ•´ç‰ˆæœ¬",
    "description": "åˆåŒæ¡£æ¡ˆç®¡ç†ç³»ç»ŸAPIæµ‹è¯•é›†åˆï¼ŒåŒ…å«OCRå¤„ç†ã€å†…å®¹åˆ†å—ã€Elasticsearchæœç´¢ç­‰å®Œæ•´åŠŸèƒ½",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "3.0.0"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "contract_id",
      "value": "20",
      "type": "string"
    },
    {
      "key": "session_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "message_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. å¥åº·æ£€æŸ¥",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has status field\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('status');",
              "    pm.expect(jsonData.status).to.eql('healthy');",
              "});",
              "",
              "pm.test(\"Response time is less than 1000ms\", function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(1000);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/health",
          "host": ["{{base_url}}"],
          "path": ["health"]
        },
        "description": "æ£€æŸ¥æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€"
      }
    },
    {
      "name": "2. ä¸Šä¼ åˆåŒæ–‡ä»¶",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Upload successful\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('contract_id');",
              "    pm.expect(jsonData).to.have.property('message');",
              "    ",
              "    // ä¿å­˜contract_idåˆ°ç¯å¢ƒå˜é‡",
              "    pm.collectionVariables.set(\"contract_id\", jsonData.contract_id);",
              "    console.log(\"Contract ID saved: \" + jsonData.contract_id);",
              "});",
              "",
              "pm.test(\"OCR processing started\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.ocr_status).to.be.oneOf(['processing', 'pending']);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "file",
              "type": "file",
              "src": [],
              "description": "é€‰æ‹©è¦ä¸Šä¼ çš„PDFæ–‡ä»¶"
            },
            {
              "key": "title",
              "value": "æµ‹è¯•åˆåŒæ–‡æ¡£",
              "type": "text",
              "description": "åˆåŒæ ‡é¢˜"
            },
            {
              "key": "description",
              "value": "è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•GLM-4.1V OCRåŠŸèƒ½çš„åˆåŒæ–‡æ¡£",
              "type": "text",
              "description": "åˆåŒæè¿°"
            }
          ]
        },
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/upload",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "upload"]
        },
        "description": "ä¸Šä¼ åˆåŒæ–‡ä»¶å¹¶è‡ªåŠ¨è§¦å‘OCRå¤„ç†"
      }
    },
    {
      "name": "3. è·å–åˆåŒåˆ—è¡¨",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has contracts array\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('contracts');",
              "    pm.expect(jsonData.contracts).to.be.an('array');",
              "});",
              "",
              "pm.test(\"Response has pagination info\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('total');",
              "    pm.expect(jsonData).to.have.property('skip');",
              "    pm.expect(jsonData).to.have.property('limit');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/?skip=0&limit=10",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", ""],
          "query": [
            {
              "key": "skip",
              "value": "0",
              "description": "è·³è¿‡çš„è®°å½•æ•°"
            },
            {
              "key": "limit",
              "value": "10",
              "description": "è¿”å›çš„è®°å½•æ•°é™åˆ¶"
            }
          ]
        },
        "description": "åˆ†é¡µè·å–æ‰€æœ‰åˆåŒåˆ—è¡¨"
      }
    },
    {
      "name": "4. è·å–åˆåŒè¯¦æƒ…",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has contract details\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('id');",
              "    pm.expect(jsonData).to.have.property('title');",
              "    pm.expect(jsonData).to.have.property('filename');",
              "    pm.expect(jsonData).to.have.property('ocr_status');",
              "});",
              "",
              "pm.test(\"Contract ID matches\", function () {",
              "    var jsonData = pm.response.json();",
              "    var expectedId = 20;",
              "    pm.expect(jsonData.id).to.eql(expectedId);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}"]
        },
        "description": "è·å–æŒ‡å®šåˆåŒçš„è¯¦ç»†ä¿¡æ¯"
      }
    },
    {
      "name": "5. æŸ¥è¯¢OCRçŠ¶æ€",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has OCR status\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('contract_id');",
              "    pm.expect(jsonData).to.have.property('ocr_status');",
              "    pm.expect(jsonData.ocr_status).to.be.oneOf(['pending', 'processing', 'completed', 'failed']);",
              "});",
              "",
              "// å¦‚æœè¿˜åœ¨å¤„ç†ä¸­ï¼Œ5ç§’åè‡ªåŠ¨é‡æ–°æŸ¥è¯¢",
              "pm.test(\"Auto retry if processing\", function () {",
              "    var jsonData = pm.response.json();",
              "    if (jsonData.ocr_status === 'processing') {",
              "        console.log(\"OCR still processing, will retry in 5 seconds...\");",
              "        setTimeout(function(){",
              "            postman.setNextRequest(\"5. æŸ¥è¯¢OCRçŠ¶æ€\");",
              "        }, 5000);",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/ocr-status",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "ocr-status"]
        },
        "description": "æŸ¥è¯¢åˆåŒOCRå¤„ç†çŠ¶æ€"
      }
    },
    {
      "name": "6. æ‰‹åŠ¨è§¦å‘OCRå¤„ç† (GLM-4.1V)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"OCR processing started\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('message');",
              "    pm.expect(jsonData).to.have.property('contract_id');",
              "    pm.expect(jsonData).to.have.property('status');",
              "    pm.expect(jsonData.status).to.eql('processing');",
              "});",
              "",
              "pm.test(\"GLM-4.1V model specified\", function () {",
              "    var jsonData = pm.response.json();",
              "    if (jsonData.model) {",
              "        pm.expect(jsonData.model).to.include('GLM-4.1V');",
              "    }",
              "});",
              "",
              "// è‡ªåŠ¨ç­‰å¾…5ç§’åæŸ¥è¯¢çŠ¶æ€",
              "setTimeout(function(){",
              "    postman.setNextRequest(\"5. æŸ¥è¯¢OCRçŠ¶æ€\");",
              "}, 5000);"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/process-ocr",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "process-ocr"]
        },
        "description": "æ‰‹åŠ¨è§¦å‘åˆåŒOCRå¤„ç†ï¼ˆä½¿ç”¨GLM-4.1Væ¨¡å‹ï¼‰"
      }
    },
    {
      "name": "7. è·å–å†…å®¹çŠ¶æ€",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has content status\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('contract_id');",
              "    pm.expect(jsonData).to.have.property('has_text_content');",
              "    pm.expect(jsonData).to.have.property('chunk_count');",
              "    pm.expect(jsonData).to.have.property('text_file_exists');",
              "});",
              "",
              "pm.test(\"Contract ID matches\", function () {",
              "    var jsonData = pm.response.json();",
              "    var expectedId = 20;",
              "    pm.expect(jsonData.contract_id).to.eql(expectedId);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/content/status",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "content", "status"]
        },
        "description": "è·å–åˆåŒå†…å®¹å¤„ç†çŠ¶æ€"
      }
    },
    {
      "name": "8. å¤„ç†å†…å®¹åˆ†å—",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Content processing successful\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('message');",
              "    pm.expect(jsonData).to.have.property('contract_id');",
              "    pm.expect(jsonData).to.have.property('chunks_created');",
              "    pm.expect(jsonData.chunks_created).to.be.a('number');",
              "    pm.expect(jsonData.chunks_created).to.be.above(0);",
              "});",
              "",
              "pm.test(\"Processing details provided\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.message).to.include('å¤„ç†å®Œæˆ');",
              "    console.log('Chunks created: ' + jsonData.chunks_created);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/content/process",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "content", "process"]
        },
        "description": "å¤„ç†åˆåŒå†…å®¹å¹¶ç”Ÿæˆåˆ†å—"
      }
    },
    {
      "name": "9. è·å–åˆ†å—åˆ—è¡¨",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has chunks array\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('chunks');",
              "    pm.expect(jsonData.chunks).to.be.an('array');",
              "});",
              "",
              "pm.test(\"Response has pagination info\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('total');",
              "    pm.expect(jsonData).to.have.property('page');",
              "    pm.expect(jsonData).to.have.property('size');",
              "});",
              "",
              "pm.test(\"Chunks have required fields\", function () {",
              "    var jsonData = pm.response.json();",
              "    if (jsonData.chunks.length > 0) {",
              "        var chunk = jsonData.chunks[0];",
              "        pm.expect(chunk).to.have.property('id');",
              "        pm.expect(chunk).to.have.property('chunk_index');",
              "        pm.expect(chunk).to.have.property('content_text');",
              "        pm.expect(chunk).to.have.property('chunk_type');",
              "        pm.expect(chunk).to.have.property('chunk_size');",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/content/chunks?page=1&size=10",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "content", "chunks"],
          "query": [
            {
              "key": "page",
              "value": "1",
              "description": "é¡µç "
            },
            {
              "key": "size",
              "value": "10",
              "description": "æ¯é¡µå¤§å°"
            }
          ]
        },
        "description": "åˆ†é¡µè·å–åˆåŒå†…å®¹åˆ†å—åˆ—è¡¨"
      }
    },
    {
      "name": "10. è·å–è‡ªåŠ¨åŒ–å¤„ç†çŠ¶æ€",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has automated processing status\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('data');",
              "    pm.expect(jsonData.data).to.have.property('contract_id');",
              "    pm.expect(jsonData.data).to.have.property('overall_status');",
              "    pm.expect(jsonData.data).to.have.property('processing_steps');",
              "});",
              "",
              "pm.test(\"Processing steps have required fields\", function () {",
              "    var jsonData = pm.response.json();",
              "    var steps = jsonData.data.processing_steps;",
              "    pm.expect(steps).to.have.property('ocr_recognition');",
              "    pm.expect(steps).to.have.property('content_chunking');",
              "    pm.expect(steps).to.have.property('elasticsearch_sync');",
              "    ",
              "    // æ£€æŸ¥æ¯ä¸ªæ­¥éª¤çš„çŠ¶æ€",
              "    pm.expect(steps.ocr_recognition).to.have.property('status');",
              "    pm.expect(steps.ocr_recognition).to.have.property('completed');",
              "    pm.expect(steps.content_chunking).to.have.property('status');",
              "    pm.expect(steps.content_chunking).to.have.property('completed');",
              "    pm.expect(steps.elasticsearch_sync).to.have.property('status');",
              "    pm.expect(steps.elasticsearch_sync).to.have.property('completed');",
              "});",
              "",
              "pm.test(\"Overall status is valid\", function () {",
              "    var jsonData = pm.response.json();",
              "    var validStatuses = ['pending', 'processing', 'completed', 'failed'];",
              "    pm.expect(validStatuses).to.include(jsonData.data.overall_status);",
              "    console.log('Overall processing status: ' + jsonData.data.overall_status);",
              "    console.log('OCR status: ' + jsonData.data.processing_steps.ocr_recognition.status);",
              "    console.log('Content chunks: ' + jsonData.data.content_chunks);",
              "    console.log('Elasticsearch synced: ' + jsonData.data.elasticsearch_synced);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/automated-status",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "automated-status"]
        },
        "description": "è·å–åˆåŒè‡ªåŠ¨åŒ–å¤„ç†çš„ç»¼åˆçŠ¶æ€ï¼ˆOCRè¯†åˆ«ã€æ–‡æ¡£åˆ‡å—ã€ElasticsearchåŒæ­¥ï¼‰"
      }
    },
    {
      "name": "11. æœç´¢åˆ†å—",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has chunks array\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('chunks');",
              "    pm.expect(jsonData.chunks).to.be.an('array');",
              "});",
              "",
              "pm.test(\"Response has search info\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('total');",
              "    pm.expect(jsonData).to.have.property('page');",
              "    pm.expect(jsonData).to.have.property('size');",
              "    pm.expect(jsonData).to.have.property('query');",
              "});",
              "",
              "pm.test(\"Search results relevant\", function () {",
              "    var jsonData = pm.response.json();",
              "    console.log('Search query: ' + jsonData.query);",
              "    console.log('Results found: ' + jsonData.total);",
              "    if (jsonData.chunks.length > 0) {",
              "        var chunk = jsonData.chunks[0];",
              "        pm.expect(chunk).to.have.property('content_text');",
              "        console.log('First result preview: ' + chunk.content_text.substring(0, 100) + '...');",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/content/search?q=åˆåŒ&page=1&size=5",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "content", "search"],
          "query": [
            {
              "key": "q",
              "value": "åˆåŒ",
              "description": "æœç´¢å…³é”®è¯"
            },
            {
              "key": "page",
              "value": "1",
              "description": "é¡µç "
            },
            {
              "key": "size",
              "value": "5",
              "description": "æ¯é¡µå¤§å°"
            }
          ]
        },
        "description": "åœ¨åˆåŒå†…å®¹åˆ†å—ä¸­æœç´¢å…³é”®è¯"
      }
    },
    {
      "name": "12. Elasticsearch å¥åº·æ£€æŸ¥",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Elasticsearch is available\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('elasticsearch_available');",
              "    pm.expect(jsonData.elasticsearch_available).to.be.true;",
              "});",
              "",
              "pm.test(\"Response has cluster info\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('cluster_name');",
              "    pm.expect(jsonData).to.have.property('version');",
              "    console.log('Elasticsearch cluster: ' + jsonData.cluster_name);",
              "    console.log('Elasticsearch version: ' + jsonData.version);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/elasticsearch/status",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "elasticsearch", "status"]
        },
        "description": "æ£€æŸ¥ Elasticsearch æœåŠ¡çŠ¶æ€å’Œè¿æ¥"
      }
    },
    {
      "name": "13. åˆå§‹åŒ– Elasticsearch ç´¢å¼•",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Indices created successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('message');",
              "    pm.expect(jsonData).to.have.property('indices_created');",
              "    pm.expect(jsonData.indices_created).to.be.an('array');",
              "    console.log('Created indices: ' + JSON.stringify(jsonData.indices_created));",
              "});",
              "",
              "pm.test(\"Required indices exist\", function () {",
              "    var jsonData = pm.response.json();",
              "    var indices = jsonData.indices_created;",
              "    pm.expect(indices).to.include('contracts');",
              "    pm.expect(indices).to.include('contract_contents');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/elasticsearch/init",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "elasticsearch", "init"]
        },
        "description": "åˆå§‹åŒ– Elasticsearch ç´¢å¼•ï¼ˆåˆåŒç´¢å¼•å’Œå†…å®¹ç´¢å¼•ï¼‰"
      }
    },
    {
      "name": "14. åŒæ­¥åˆåŒåˆ° Elasticsearch",
        "event": [
          {
            "listen": "test",
            "script": {
              "exec": [
                "pm.test(\"Status code is 200\", function () {",
                "    pm.response.to.have.status(200);",
                "});",
                "",
                "pm.test(\"Sync completed successfully\", function () {",
                "    var jsonData = pm.response.json();",
                "    pm.expect(jsonData).to.have.property('message');",
                "    pm.expect(jsonData).to.have.property('synced_contracts');",
                "    pm.expect(jsonData).to.have.property('synced_contents');",
                "    console.log('Synced contracts: ' + jsonData.synced_contracts);",
                "    console.log('Synced contents: ' + jsonData.synced_contents);",
                "});",
                "",
                "pm.test(\"Sync statistics valid\", function () {",
                "    var jsonData = pm.response.json();",
                "    pm.expect(jsonData.synced_contracts).to.be.a('number');",
                "    pm.expect(jsonData.synced_contents).to.be.a('number');",
                "    pm.expect(jsonData.synced_contracts).to.be.at.least(0);",
                "    pm.expect(jsonData.synced_contents).to.be.at.least(0);",
                "});"
              ],
              "type": "text/javascript"
            }
          }
        ],
        "request": {
          "method": "POST",
          "header": [],
          "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/elasticsearch/sync",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "elasticsearch", "sync"]
        },
          "description": "å°†ç°æœ‰åˆåŒæ•°æ®åŒæ­¥åˆ° Elasticsearch ç´¢å¼•"
        }
    },
    {
      "name": "15. è‡ªåŠ¨åŒ–å¤„ç†åˆåŒï¼ˆOCR+åˆ‡ç‰‡+ESåŒæ­¥ï¼‰",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Automated processing started\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('message');",
              "    pm.expect(jsonData).to.have.property('data');",
              "    pm.expect(jsonData.data).to.have.property('contract_id');",
              "    pm.expect(jsonData.data).to.have.property('processing_status');",
              "});",
              "",
              "pm.test(\"Processing steps initiated\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.data).to.have.property('steps_initiated');",
              "    pm.expect(jsonData.data.steps_initiated).to.be.an('array');",
              "    pm.expect(jsonData.data.steps_initiated).to.include('OCRè¯†åˆ«');",
              "    pm.expect(jsonData.data.steps_initiated).to.include('æ–‡æ¡£åˆ‡å—');",
              "    pm.expect(jsonData.data.steps_initiated).to.include('ElasticsearchåŒæ­¥');",
              "    console.log('Automated processing started for contract: ' + jsonData.data.contract_id);",
              "    console.log('Processing steps: ' + JSON.stringify(jsonData.data.steps_initiated));",
              "});",
              "",
              "// è‡ªåŠ¨ç­‰å¾…5ç§’åæŸ¥è¯¢è‡ªåŠ¨åŒ–å¤„ç†çŠ¶æ€",
              "setTimeout(function(){",
              "    postman.setNextRequest(\"10. è·å–è‡ªåŠ¨åŒ–å¤„ç†çŠ¶æ€\");",
              "}, 5000);"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"force_reprocess\": false\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}/process-automated",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}", "process-automated"]
        },
        "description": "ä¸€é”®è‡ªåŠ¨åŒ–å¤„ç†åˆåŒï¼šOCRè¯†åˆ« â†’ æ–‡æ¡£åˆ‡å— â†’ ElasticsearchåŒæ­¥"
      }
    },
    {
      "name": "16. å…¨å±€åˆåŒæœç´¢",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has search results\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('contracts');",
              "    pm.expect(jsonData.contracts).to.be.an('array');",
              "    pm.expect(jsonData).to.have.property('total');",
              "    pm.expect(jsonData).to.have.property('page');",
              "    pm.expect(jsonData).to.have.property('size');",
              "});",
              "",
              "pm.test(\"Search metadata valid\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('query');",
              "    pm.expect(jsonData).to.have.property('took');",
              "    pm.expect(jsonData.took).to.be.a('number');",
              "    console.log('Search query: ' + jsonData.query);",
              "    console.log('Search took: ' + jsonData.took + 'ms');",
              "    console.log('Total results: ' + jsonData.total);",
              "});",
              "",
              "pm.test(\"Contract results have required fields\", function () {",
              "    var jsonData = pm.response.json();",
              "    if (jsonData.contracts.length > 0) {",
              "        var contract = jsonData.contracts[0];",
              "        pm.expect(contract).to.have.property('id');",
              "        pm.expect(contract).to.have.property('contract_name');",
              "        pm.expect(contract).to.have.property('contract_number');",
              "        pm.expect(contract).to.have.property('score');",
              "        console.log('First result: ' + contract.contract_name + ' (score: ' + contract.score + ')');",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/elasticsearch/search?q=åˆåŒ&page=1&size=10",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "elasticsearch", "search"],
          "query": [
            {
              "key": "q",
              "value": "åˆåŒ",
              "description": "æœç´¢å…³é”®è¯"
            },
            {
              "key": "page",
              "value": "1",
              "description": "é¡µç "
            },
            {
              "key": "size",
              "value": "10",
              "description": "æ¯é¡µå¤§å°"
            }
          ]
        },
        "description": "åœ¨æ‰€æœ‰åˆåŒä¸­è¿›è¡Œå…¨å±€æœç´¢"
      }
    },
    {
      "name": "17. èŒä¸šç—…å±å®³å› ç´ æœç´¢ç¤ºä¾‹",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has content results\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('contents');",
              "    pm.expect(jsonData.contents).to.be.an('array');",
              "    pm.expect(jsonData).to.have.property('total');",
              "    pm.expect(jsonData).to.have.property('page');",
              "    pm.expect(jsonData).to.have.property('size');",
              "});",
              "",
              "pm.test(\"Content search metadata valid\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('query');",
              "    pm.expect(jsonData).to.have.property('took');",
              "    pm.expect(jsonData.took).to.be.a('number');",
              "    console.log('Content search query: ' + jsonData.query);",
              "    console.log('Content search took: ' + jsonData.took + 'ms');",
              "    console.log('Total content results: ' + jsonData.total);",
              "});",
              "",
              "pm.test(\"Content results have required fields\", function () {",
              "    var jsonData = pm.response.json();",
              "    if (jsonData.contents.length > 0) {",
              "        var content = jsonData.contents[0];",
              "        pm.expect(content).to.have.property('id');",
              "        pm.expect(content).to.have.property('contract_id');",
              "        pm.expect(content).to.have.property('content_text');",
              "        pm.expect(content).to.have.property('score');",
              "        pm.expect(content).to.have.property('highlight');",
              "        console.log('First content result from contract: ' + content.contract_id);",
              "        console.log('Content preview: ' + content.content_text.substring(0, 100) + '...');",
              "        if (content.highlight && content.highlight.content_text) {",
              "            console.log('Highlighted text: ' + content.highlight.content_text[0]);",
              "        }",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/elasticsearch/search?q=èŒä¸šç—…å±å®³å› ç´ åˆ†ç±»ç›®å½•&page=1&size=10",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "elasticsearch", "search"],
          "query": [
            {
              "key": "q",
              "value": "èŒä¸šç—…å±å®³å› ç´ åˆ†ç±»ç›®å½•",
              "description": "æœç´¢å…³é”®è¯"
            },
            {
              "key": "page",
              "value": "1",
              "description": "é¡µç "
            },
            {
              "key": "size",
              "value": "10",
              "description": "æ¯é¡µå¤§å°"
            }
          ]
        },
        "description": "èŒä¸šç—…å±å®³å› ç´ æœç´¢ç¤ºä¾‹"
      }
    },
    {
      "name": "18. åˆ é™¤åˆåŒ (è°¨æ…ä½¿ç”¨)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Contract deleted successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('message');",
              "    pm.expect(jsonData).to.have.property('contract_id');",
              "    pm.expect(jsonData.message).to.include('åˆ é™¤æˆåŠŸ');",
              "});",
              "",
              "pm.test(\"Files deleted\", function () {",
              "    var jsonData = pm.response.json();",
              "    if (jsonData.deleted_files) {",
              "        pm.expect(jsonData.deleted_files).to.be.an('array');",
              "    }",
              "});",
              "",
              "// æ¸…é™¤ç¯å¢ƒå˜é‡ä¸­çš„contract_id",
              "pm.collectionVariables.unset(\"contract_id\");",
              "console.log(\"Contract ID cleared from variables\");"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/contracts/{{contract_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "contracts", "{{contract_id}}"]
        },
        "description": "åˆ é™¤æŒ‡å®šåˆåŒåŠç›¸å…³æ–‡ä»¶ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰"
      }
    },
    {
      "name": "19. æé—®å¹¶è·å–AIå›ç­”",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has required fields', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData).to.have.property('data');",
              "    pm.expect(jsonData.data).to.have.property('session_id');",
              "    pm.expect(jsonData.data).to.have.property('message_id');",
              "    pm.expect(jsonData.data).to.have.property('answer');",
              "});",
              "",
              "// ä¿å­˜session_idå’Œmessage_idä¾›åç»­è¯·æ±‚ä½¿ç”¨",
              "if (pm.response.code === 200) {",
              "    var jsonData = pm.response.json();",
              "    pm.collectionVariables.set('session_id', jsonData.data.session_id);",
              "    pm.collectionVariables.set('message_id', jsonData.data.message_id);",
              "    console.log('Session ID saved: ' + jsonData.data.session_id);",
              "    console.log('Message ID saved: ' + jsonData.data.message_id);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"question\": \"è¯·é—®è¿™ä¸ªåˆåŒçš„ä¸»è¦å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ\",\n  \"session_id\": null,\n  \"search_method\": \"hybrid\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/qa/ask",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "qa", "ask"]
        },
        "description": "å‘AIæé—®å¹¶è·å–åŸºäºåˆåŒå†…å®¹çš„å›ç­”"
      }
    },
    {
      "name": "20. è·å–ä¼šè¯åˆ—è¡¨",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has required fields', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData).to.have.property('data');",
              "    pm.expect(jsonData.data).to.have.property('sessions');",
              "    pm.expect(jsonData.data.sessions).to.be.an('array');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/qa/sessions?page=1&size=10",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "qa", "sessions"],
          "query": [
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "size",
              "value": "10"
            }
          ]
        },
        "description": "è·å–ç”¨æˆ·çš„é—®ç­”ä¼šè¯åˆ—è¡¨"
      }
    },
    {
      "name": "21. è·å–ä¼šè¯å†å²è®°å½•",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// æ£€æŸ¥session_idæ˜¯å¦å­˜åœ¨",
              "var sessionId = pm.collectionVariables.get('session_id');",
              "if (!sessionId) {",
              "    console.warn('Warning: session_id not set. Please run ask question request first.');",
              "}"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has required fields', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData).to.have.property('data');",
              "    pm.expect(jsonData.data).to.have.property('session_id');",
              "    pm.expect(jsonData.data).to.have.property('messages');",
              "    pm.expect(jsonData.data.messages).to.be.an('array');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/qa/sessions/{{session_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "qa", "sessions", "{{session_id}}"]
        },
        "description": "è·å–æŒ‡å®šä¼šè¯çš„å®Œæ•´å†å²è®°å½•"
      }
    },
    {
      "name": "22. æäº¤ç”¨æˆ·åé¦ˆ",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// æ£€æŸ¥session_idå’Œmessage_idæ˜¯å¦å­˜åœ¨",
              "var sessionId = pm.collectionVariables.get('session_id');",
              "var messageId = pm.collectionVariables.get('message_id');",
              "if (!sessionId || !messageId) {",
              "    console.warn('Warning: session_id or message_id not set. Please run ask question request first.');",
              "}"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has success field', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData.success).to.be.true;",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"feedback_type\": \"like\",\n  \"comment\": \"å›ç­”å¾ˆæœ‰å¸®åŠ©\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/qa/sessions/{{session_id}}/messages/{{message_id}}/feedback",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "qa", "sessions", "{{session_id}}", "messages", "{{message_id}}", "feedback"]
        },
        "description": "å¯¹AIå›ç­”æäº¤ç”¨æˆ·åé¦ˆï¼ˆç‚¹èµ/ç‚¹è¸©/è¯„è®ºï¼‰"
      }
    },
    {
      "name": "23. åˆ é™¤ä¼šè¯",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// æ£€æŸ¥session_idæ˜¯å¦å­˜åœ¨",
              "var sessionId = pm.collectionVariables.get('session_id');",
              "if (!sessionId) {",
              "    console.warn('Warning: session_id not set. Please run ask question request first.');",
              "}"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has success field', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData.success).to.be.true;",
              "});",
              "",
              "// æ¸…é™¤ä¿å­˜çš„session_id",
              "pm.collectionVariables.unset('session_id');",
              "pm.collectionVariables.unset('message_id');",
              "console.log('Session variables cleared.');"
            ]
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/qa/sessions/{{session_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "qa", "sessions", "{{session_id}}"]
        },
        "description": "åˆ é™¤æŒ‡å®šçš„é—®ç­”ä¼šè¯åŠå…¶æ‰€æœ‰æ¶ˆæ¯è®°å½•"
      }
    },
    {
      "name": "24. ä¸€é”®æ¸…ç©ºæ‰€æœ‰å·²åŒæ­¥æ•°æ® (å¼€å‘ç¯å¢ƒä¸“ç”¨)",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// è­¦å‘Šæç¤ºï¼šè¿™æ˜¯ä¸€ä¸ªå±é™©æ“ä½œ",
              "console.warn('âš ï¸  WARNING: This will clear all Elasticsearch data and reset vector statuses!');",
              "console.warn('âš ï¸  This endpoint is for DEVELOPMENT ONLY - DO NOT use in production!');",
              "console.log('Operation will:');",
              "console.log('- Clear all Elasticsearch documents OR recreate indices');",
              "console.log('- Reset all contract/chunk vector statuses to pending');",
              "console.log('- Clear vector ID mappings');",
              "console.log('- Keep database records and uploaded files intact');"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has success field', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData.success).to.be.true;",
              "});",
              "",
              "pm.test('Response has clearance data', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('data');",
              "    pm.expect(jsonData.data).to.have.property('elasticsearch');",
              "    pm.expect(jsonData.data).to.have.property('vectors');",
              "    pm.expect(jsonData.data).to.have.property('notes');",
              "});",
              "",
              "pm.test('Elasticsearch operation succeeded', function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.data.elasticsearch.success).to.be.true;",
              "});",
              "",
              "console.log('ğŸ§¹ Clear operation completed:');",
              "console.log('- ES Action:', pm.response.json().data.elasticsearch.action);",
              "console.log('- Contracts Reset:', pm.response.json().data.vectors.contracts_reset);",
              "console.log('- Chunks Reset:', pm.response.json().data.vectors.chunks_reset);",
              "console.log('âš ï¸  Remember to re-upload and process contracts for testing!');"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"reset_indices\": false\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/maintenance/clear-all?reset_indices=false",
          "host": ["{{base_url}}"],
          "path": ["maintenance", "clear-all"],
          "query": [
            {
              "key": "reset_indices",
              "value": "false",
              "description": "æ˜¯å¦å®Œå…¨é‡å»ºç´¢å¼•ï¼ˆtrueï¼‰è¿˜æ˜¯ä»…æ¸…ç©ºæ–‡æ¡£ï¼ˆfalseï¼Œé»˜è®¤ï¼‰"
            }
          ]
        },
        "description": "âš ï¸ å¼€å‘ç¯å¢ƒä¸“ç”¨ï¼šä¸€é”®æ¸…ç©ºæ‰€æœ‰ESæ–‡æ¡£å’Œå‘é‡çŠ¶æ€ï¼Œä¾¿äºé‡æ–°æµ‹è¯•ã€‚\n\n**æ“ä½œå†…å®¹ï¼š**\n- æ¸…ç©º/é‡å»º Elasticsearch ç´¢å¼•ä¸­çš„æ‰€æœ‰æ–‡æ¡£\n- é‡ç½®æ‰€æœ‰åˆåŒå’Œåˆ†å—çš„å‘é‡çŠ¶æ€ä¸º pending\n- æ¸…ç©ºå‘é‡IDæ˜ å°„å…³ç³»\n- ä¿ç•™æ•°æ®åº“è®°å½•å’Œä¸Šä¼ æ–‡ä»¶ä¸å˜\n\n**å‚æ•°è¯´æ˜ï¼š**\n- `reset_indices=false`ï¼šä»…æ¸…ç©ºæ–‡æ¡£ï¼Œä¿ç•™ç´¢å¼•ç»“æ„ï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰\n- `reset_indices=true`ï¼šå®Œå…¨åˆ é™¤å¹¶é‡æ–°åˆ›å»ºç´¢å¼•\n\n**æ³¨æ„äº‹é¡¹ï¼š**\n- ä»…ä¾›æœ¬åœ°å¼€å‘æµ‹è¯•ä½¿ç”¨\n- ç”Ÿäº§ç¯å¢ƒè¯·å‹¿æš´éœ²æ­¤æ¥å£\n- æ“ä½œåéœ€é‡æ–°ä¸Šä¼ å¹¶å¤„ç†åˆåŒè¿›è¡Œæµ‹è¯•"
      }
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// å…¨å±€å‰ç½®è„šæœ¬",
          "console.log('Request to: ' + pm.request.url);",
          "console.log('Method: ' + pm.request.method);",
          "",
          "// æ£€æŸ¥contract_idæ˜¯å¦å­˜åœ¨ï¼ˆé™¤äº†å¥åº·æ£€æŸ¥ã€ä¸Šä¼ æ¥å£ã€å…¨å±€æœç´¢æ¥å£å’Œç»´æŠ¤æ¥å£ï¼‰",
          "var requestName = pm.info.requestName;",
          "var needsContractId = ['4. è·å–åˆåŒè¯¦æƒ…', '5. æŸ¥è¯¢OCRçŠ¶æ€', '6. æ‰‹åŠ¨è§¦å‘OCRå¤„ç† (GLM-4.1V)', '7. è·å–å†…å®¹çŠ¶æ€', '8. å¤„ç†å†…å®¹åˆ†å—', '9. è·å–åˆ†å—åˆ—è¡¨', '10. è·å–è‡ªåŠ¨åŒ–å¤„ç†çŠ¶æ€', '11. æœç´¢åˆ†å—', '14. åŒæ­¥åˆåŒåˆ° Elasticsearch', '15. è‡ªåŠ¨åŒ–å¤„ç†åˆåŒï¼ˆOCR+åˆ‡ç‰‡+ESåŒæ­¥ï¼‰', '18. åˆ é™¤åˆåŒ (è°¨æ…ä½¿ç”¨)'];",
          "",
          "if (needsContractId.includes(requestName)) {",
          "    var contractId = pm.collectionVariables.get('contract_id');",
          "    if (!contractId) {",
          "        console.warn('Warning: contract_id not set. Please run upload request first.');",
          "    }",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// å…¨å±€åç½®è„šæœ¬",
          "console.log('Response status: ' + pm.response.status);",
          "console.log('Response time: ' + pm.response.responseTime + 'ms');",
          "",
          "// è®°å½•é”™è¯¯ä¿¡æ¯",
          "if (pm.response.code >= 400) {",
          "    console.error('Error response: ' + pm.response.text());",
          "}"
        ]
      }
    }
  ]
}